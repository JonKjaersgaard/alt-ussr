# OS-specific variables
JAVAINCLUDE=-I"C:\Program Files\Java\jdk1.5.0_02\include" -I"C:\Program Files\Java\jdk1.5.0_02\include\win32"
CFLAGS=-fPIC -DUSSR $(JAVAINCLUDE)
LDFLAGS=-shared --enable-stdcall-fixup 

# General variables
SRC=nativeController.c $(API).c $(CONTROLLER).c
BIN=$(SRC:.c=.o)
CC=gcc

all: nativeController.dll
	copy nativeController.dll ..\lib\$(CONTROLLER).dll
nativeController.h: ../bin/ussr/samples/atron/ATRONNativeController.class
	javah -jni -classpath ../bin -o nativeController.h ussr.samples.atron.ATRONNativeController
nativeController.dll: nativeController.h $(BIN)
	gcc $(LDFLAGS) -o nativeController.dll nativeController.o $(CONTROLLER).o $(API).o nativeController.def
clean:
	rm -f .depends nativeController.dll nativeController.h $(BIN)
.depends: nativeController.h
	gcc $(JAVAINCLUDE) -M $(SRC) > .depends
include .depends
